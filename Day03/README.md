# 前言
今天把日志写到文件中去。其实原理很简单，只是把原来输出到终端变成现在的文件即可。但是其中有一些细节需要处理

# 实现细节
1. 新建可写文件，模式为追加ae
2. 滚动(rolling)。
    - 如果文件满了，需要重建一个新的文件(默认是1GB)
    - 如果跨天了，也会新建一个文件(每天新建一个)
4. 刷新
    - 每3s会刷新一下缓冲区到文件
    - 当写日志次数超过一个阈值，也会触发刷新缓冲区
5. 自定义文件的缓冲区为64 * 1024 （这个应该是需要根据经验来的）

# 关键类
### LogFile类
LogFile日志文件类，实现日志滚动，完成日志文件的管理工作.
- rollfile() ：滚动文件 当日志超过m_rollsize大小时会滚动一个新的日志文件出来.
- get_log_file_name() ：用与滚动日志时，给日志文件取名，以滚动时间作为后缀.
- m_mutex ：用于append()数据时,给文件上锁.
- append() ：黏入日志.
- flush() ：冲刷缓冲.
- 一个典型的日志文件名
serverlog.20131010-20-604.7743.log
UTC时间和GMT时间是一样的，北京时间为UTC+8


### File类
它是最终用于操作本地文件的类.
- append() : 里面会调用系统函数fwrite()写入本地文件.
- flush() ： 冲刷缓冲.
- writtenBytes() ： 获取已写字节数.

##### File类不是线程安全的，因为是无锁写入（提高效率）。通过LogFile类保证了线程安全

多个线程对同一文件写入，效率可能不如单个线程，因为IO总线不能运行
如果一定要多个线程写入，采用异步线程（之后会讲到）